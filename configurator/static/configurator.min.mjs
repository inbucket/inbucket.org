var g=class{withFields(t){let r=Object.keys(this).map(n=>n in t?t[n]:this[n]);return new this.constructor(...r)}},Se=class{static fromArray(t,r){let n=r||new Ee;for(let i=t.length-1;i>=0;--i)n=new he(t[i],n);return n}[Symbol.iterator](){return new Pr(this)}toArray(){return[...this]}atLeastLength(t){let r=this;for(;t-- >0&&r;)r=r.tail;return r!==void 0}hasLength(t){let r=this;for(;t-- >0&&r;)r=r.tail;return t===-1&&r instanceof Ee}countLength(){let t=this,r=0;for(;t;)t=t.tail,r++;return r-1}};function $(e,t){return new he(e,t)}function o(e,t){return Se.fromArray(e,t)}var Pr=class{#e;constructor(t){this.#e=t}next(){if(this.#e instanceof Ee)return{done:!0};{let{head:t,tail:r}=this.#e;return this.#e=r,{value:t,done:!1}}}},Ee=class extends Se{},he=class extends Se{constructor(t,r){super(),this.head=t,this.tail=r}},Ce=class{bitSize;byteSize;bitOffset;rawBuffer;constructor(t,r,n){if(!(t instanceof Uint8Array))throw globalThis.Error("BitArray can only be constructed from a Uint8Array");if(this.bitSize=r??t.length*8,this.byteSize=Math.trunc((this.bitSize+7)/8),this.bitOffset=n??0,this.bitSize<0)throw globalThis.Error(`BitArray bit size is invalid: ${this.bitSize}`);if(this.bitOffset<0||this.bitOffset>7)throw globalThis.Error(`BitArray bit offset is invalid: ${this.bitOffset}`);if(t.length!==Math.trunc((this.bitOffset+this.bitSize+7)/8))throw globalThis.Error("BitArray buffer length is invalid");this.rawBuffer=t}byteAt(t){if(!(t<0||t>=this.byteSize))return St(this.rawBuffer,this.bitOffset,t)}equals(t){if(this.bitSize!==t.bitSize)return!1;let r=Math.trunc(this.bitSize/8);if(this.bitOffset===0&&t.bitOffset===0){for(let i=0;i<r;i++)if(this.rawBuffer[i]!==t.rawBuffer[i])return!1;let n=this.bitSize%8;if(n){let i=8-n;if(this.rawBuffer[r]>>i!==t.rawBuffer[r]>>i)return!1}}else{for(let i=0;i<r;i++){let s=St(this.rawBuffer,this.bitOffset,i),u=St(t.rawBuffer,t.bitOffset,i);if(s!==u)return!1}let n=this.bitSize%8;if(n){let i=St(this.rawBuffer,this.bitOffset,r),s=St(t.rawBuffer,t.bitOffset,r),u=8-n;if(i>>u!==s>>u)return!1}}return!0}get buffer(){if(oi("buffer","Use BitArray.byteAt() or BitArray.rawBuffer instead"),this.bitOffset!==0||this.bitSize%8!==0)throw new globalThis.Error("BitArray.buffer does not support unaligned bit arrays");return this.rawBuffer}get length(){if(oi("length","Use BitArray.bitSize or BitArray.byteSize instead"),this.bitOffset!==0||this.bitSize%8!==0)throw new globalThis.Error("BitArray.length does not support unaligned bit arrays");return this.rawBuffer.length}};function St(e,t,r){if(t===0)return e[r]??0;{let n=e[r]<<t&255,i=e[r+1]>>8-t;return n|i}}var Et=class{constructor(t){this.value=t}},si={};function oi(e,t){si[e]||(console.warn(`Deprecated BitArray.${e} property used in JavaScript FFI code. ${t}.`),si[e]=!0)}function Qt(e,t,r){if(r??=e.bitSize,ai(e,t,r),t===r)return new Ce(new Uint8Array);if(t===0&&r===e.bitSize)return e;t+=e.bitOffset,r+=e.bitOffset;let n=Math.trunc(t/8),s=Math.trunc((r+7)/8)-n,u;return n===0&&s===e.rawBuffer.byteLength?u=e.rawBuffer:u=new Uint8Array(e.rawBuffer.buffer,e.rawBuffer.byteOffset+n,s),new Ce(u,r-t,t%8)}function li(e,t,r,n,i){if(ai(e,t,r),t===r)return 0;t+=e.bitOffset,r+=e.bitOffset;let s=t%8===0,u=r%8===0;if(s&&u)return uo(e,t/8,r/8,n,i);let l=r-t,a=Math.trunc(t/8),c=Math.trunc((r-1)/8);if(a==c){let p=255>>t%8,d=(8-r%8)%8,m=(e.rawBuffer[a]&p)>>d;if(i){let x=2**(l-1);m>=x&&(m-=x*2)}return m}return l<=53?co(e.rawBuffer,t,r,n,i):fo(e.rawBuffer,t,r,n,i)}function uo(e,t,r,n,i){return r-t<=6?lo(e.rawBuffer,t,r,n,i):ao(e.rawBuffer,t,r,n,i)}function lo(e,t,r,n,i){let s=r-t,u=0;if(n)for(let l=t;l<r;l++)u*=256,u+=e[l];else for(let l=r-1;l>=t;l--)u*=256,u+=e[l];if(i){let l=2**(s*8-1);u>=l&&(u-=l*2)}return u}function ao(e,t,r,n,i){let s=r-t,u=0n;if(n)for(let l=t;l<r;l++)u*=256n,u+=BigInt(e[l]);else for(let l=r-1;l>=t;l--)u*=256n,u+=BigInt(e[l]);if(i){let l=1n<<BigInt(s*8-1);u>=l&&(u-=l*2n)}return Number(u)}function co(e,t,r,n,i){let s=t%8===0,u=r-t,l=Math.trunc(t/8),a=0;if(n){if(!s){let c=8-t%8;a=e[l++]&(1<<c)-1,u-=c}for(;u>=8;)a*=256,a+=e[l++],u-=8;u>0&&(a*=2**u,a+=e[l]>>8-u)}else if(s){let c=r-t,p=1;for(;c>=8;)a+=e[l++]*p,p*=256,c-=8;a+=(e[l]>>8-c)*p}else{let c=t%8,p=8-c,d=r-t,m=1;for(;d>=8;){let x=e[l]<<c|e[l+1]>>p;a+=(x&255)*m,m*=256,d-=8,l++}if(d>0){let x=d-Math.max(0,d-p),_=(e[l]&(1<<p)-1)>>p-x;d-=x,d>0&&(_*=2**d,_+=e[l+1]>>8-d),a+=_*m}}if(i){let c=2**(r-t-1);a>=c&&(a-=c*2)}return a}function fo(e,t,r,n,i){let s=t%8===0,u=r-t,l=Math.trunc(t/8),a=0n;if(n){if(!s){let c=8-t%8;a=BigInt(e[l++]&(1<<c)-1),u-=c}for(;u>=8;)a*=256n,a+=BigInt(e[l++]),u-=8;u>0&&(a<<=BigInt(u),a+=BigInt(e[l]>>8-u))}else if(s){let c=r-t,p=0n;for(;c>=8;)a+=BigInt(e[l++])<<p,p+=8n,c-=8;a+=BigInt(e[l]>>8-c)<<p}else{let c=t%8,p=8-c,d=r-t,m=0n;for(;d>=8;){let x=e[l]<<c|e[l+1]>>p;a+=BigInt(x&255)<<m,m+=8n,d-=8,l++}if(d>0){let x=d-Math.max(0,d-p),_=(e[l]&(1<<p)-1)>>p-x;d-=x,d>0&&(_<<=d,_+=e[l+1]>>8-d),a+=BigInt(_)<<m}}if(i){let c=2n**BigInt(r-t-1);a>=c&&(a-=c*2n)}return Number(a)}function ai(e,t,r){if(t<0||t>e.bitSize||r<t||r>e.bitSize){let n=`Invalid bit array slice: start = ${t}, end = ${r}, bit size = ${e.bitSize}`;throw new globalThis.Error(n)}}var ht=class e extends g{static isResult(t){return t instanceof e}},I=class extends ht{constructor(t){super(),this[0]=t}isOk(){return!0}},T=class extends ht{constructor(t){super(),this[0]=t}isOk(){return!1}};function D(e,t){let r=[e,t];for(;r.length;){let n=r.pop(),i=r.pop();if(n===i)continue;if(!ui(n)||!ui(i)||!bo(n,i)||mo(n,i)||ho(n,i)||_o(n,i)||$o(n,i)||xo(n,i)||go(n,i))return!1;let u=Object.getPrototypeOf(n);if(u!==null&&typeof u.equals=="function")try{if(n.equals(i))continue;return!1}catch{}let[l,a]=po(n);for(let c of l(n))r.push(a(n,c),a(i,c))}return!0}function po(e){if(e instanceof Map)return[t=>t.keys(),(t,r)=>t.get(r)];{let t=e instanceof globalThis.Error?["message"]:[];return[r=>[...t,...Object.keys(r)],(r,n)=>r[n]]}}function mo(e,t){return e instanceof Date&&(e>t||e<t)}function ho(e,t){return!(e instanceof Ce)&&e.buffer instanceof ArrayBuffer&&e.BYTES_PER_ELEMENT&&!(e.byteLength===t.byteLength&&e.every((r,n)=>r===t[n]))}function _o(e,t){return Array.isArray(e)&&e.length!==t.length}function $o(e,t){return e instanceof Map&&e.size!==t.size}function xo(e,t){return e instanceof Set&&(e.size!=t.size||[...e].some(r=>!t.has(r)))}function go(e,t){return e instanceof RegExp&&(e.source!==t.source||e.flags!==t.flags)}function ui(e){return typeof e=="object"&&e!==null}function bo(e,t){return typeof e!="object"&&typeof t!="object"&&(!e||!t)||[Promise,WeakSet,WeakMap,Function].some(n=>e instanceof n)?!1:e.constructor===t.constructor}function zr(e,t,r,n,i,s){let u=new globalThis.Error(i);u.gleam_error=e,u.module=t,u.line=r,u.function=n,u.fn=n;for(let l in s)u[l]=s[l];return u}var ci=new WeakMap,Dr=new DataView(new ArrayBuffer(8)),Ur=0;function Rr(e){let t=ci.get(e);if(t!==void 0)return t;let r=Ur++;return Ur===2147483647&&(Ur=0),ci.set(e,r),r}function qr(e,t){return e^t+2654435769+(e<<6)+(e>>2)|0}function Kr(e){let t=0,r=e.length;for(let n=0;n<r;n++)t=Math.imul(31,t)+e.charCodeAt(n)|0;return t}function pi(e){Dr.setFloat64(0,e);let t=Dr.getInt32(0),r=Dr.getInt32(4);return Math.imul(73244475,t>>16^t)^r}function wo(e){return Kr(e.toString())}function yo(e){let t=Object.getPrototypeOf(e);if(t!==null&&typeof t.hashCode=="function")try{let n=e.hashCode(e);if(typeof n=="number")return n}catch{}if(e instanceof Promise||e instanceof WeakSet||e instanceof WeakMap)return Rr(e);if(e instanceof Date)return pi(e.getTime());let r=0;if(e instanceof ArrayBuffer&&(e=new Uint8Array(e)),Array.isArray(e)||e instanceof Uint8Array)for(let n=0;n<e.length;n++)r=Math.imul(31,r)+be(e[n])|0;else if(e instanceof Set)e.forEach(n=>{r=r+be(n)|0});else if(e instanceof Map)e.forEach((n,i)=>{r=r+qr(be(n),be(i))|0});else{let n=Object.keys(e);for(let i=0;i<n.length;i++){let s=n[i],u=e[s];r=r+qr(be(u),Kr(s))|0}}return r}function be(e){if(e===null)return 1108378658;if(e===void 0)return 1108378659;if(e===!0)return 1108378657;if(e===!1)return 1108378656;switch(typeof e){case"number":return pi(e);case"string":return Kr(e);case"bigint":return wo(e);case"object":return yo(e);case"symbol":return Rr(e);case"function":return Rr(e);default:return 0}}var Me=5,Gr=Math.pow(2,Me),ko=Gr-1,vo=Gr/2,jo=Gr/4,ce=0,Ie=1,_e=2,st=3,Hr={type:_e,bitmap:0,array:[]};function Tt(e,t){return e>>>t&ko}function er(e,t){return 1<<Tt(e,t)}function Lo(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),e=e+(e>>4)&252645135,e+=e>>8,e+=e>>16,e&127}function Wr(e,t){return Lo(e&t-1)}function we(e,t,r){let n=e.length,i=new Array(n);for(let s=0;s<n;++s)i[s]=e[s];return i[t]=r,i}function Oo(e,t,r){let n=e.length,i=new Array(n+1),s=0,u=0;for(;s<t;)i[u++]=e[s++];for(i[u++]=r;s<n;)i[u++]=e[s++];return i}function Fr(e,t){let r=e.length,n=new Array(r-1),i=0,s=0;for(;i<t;)n[s++]=e[i++];for(++i;i<r;)n[s++]=e[i++];return n}function di(e,t,r,n,i,s){let u=be(t);if(u===n)return{type:st,hash:u,array:[{type:ce,k:t,v:r},{type:ce,k:i,v:s}]};let l={val:!1};return At(Vr(Hr,e,u,t,r,l),e,n,i,s,l)}function At(e,t,r,n,i,s){switch(e.type){case Ie:return So(e,t,r,n,i,s);case _e:return Vr(e,t,r,n,i,s);case st:return Eo(e,t,r,n,i,s)}}function So(e,t,r,n,i,s){let u=Tt(r,t),l=e.array[u];if(l===void 0)return s.val=!0,{type:Ie,size:e.size+1,array:we(e.array,u,{type:ce,k:n,v:i})};if(l.type===ce)return D(n,l.k)?i===l.v?e:{type:Ie,size:e.size,array:we(e.array,u,{type:ce,k:n,v:i})}:(s.val=!0,{type:Ie,size:e.size,array:we(e.array,u,di(t+Me,l.k,l.v,r,n,i))});let a=At(l,t+Me,r,n,i,s);return a===l?e:{type:Ie,size:e.size,array:we(e.array,u,a)}}function Vr(e,t,r,n,i,s){let u=er(r,t),l=Wr(e.bitmap,u);if((e.bitmap&u)!==0){let a=e.array[l];if(a.type!==ce){let p=At(a,t+Me,r,n,i,s);return p===a?e:{type:_e,bitmap:e.bitmap,array:we(e.array,l,p)}}let c=a.k;return D(n,c)?i===a.v?e:{type:_e,bitmap:e.bitmap,array:we(e.array,l,{type:ce,k:n,v:i})}:(s.val=!0,{type:_e,bitmap:e.bitmap,array:we(e.array,l,di(t+Me,c,a.v,r,n,i))})}else{let a=e.array.length;if(a>=vo){let c=new Array(32),p=Tt(r,t);c[p]=Vr(Hr,t+Me,r,n,i,s);let d=0,m=e.bitmap;for(let x=0;x<32;x++){if((m&1)!==0){let _=e.array[d++];c[x]=_}m=m>>>1}return{type:Ie,size:a+1,array:c}}else{let c=Oo(e.array,l,{type:ce,k:n,v:i});return s.val=!0,{type:_e,bitmap:e.bitmap|u,array:c}}}}function Eo(e,t,r,n,i,s){if(r===e.hash){let u=Yr(e,n);if(u!==-1)return e.array[u].v===i?e:{type:st,hash:r,array:we(e.array,u,{type:ce,k:n,v:i})};let l=e.array.length;return s.val=!0,{type:st,hash:r,array:we(e.array,l,{type:ce,k:n,v:i})}}return At({type:_e,bitmap:er(e.hash,t),array:[e]},t,r,n,i,s)}function Yr(e,t){let r=e.array.length;for(let n=0;n<r;n++)if(D(t,e.array[n].k))return n;return-1}function Zt(e,t,r,n){switch(e.type){case Ie:return To(e,t,r,n);case _e:return Ao(e,t,r,n);case st:return Bo(e,n)}}function To(e,t,r,n){let i=Tt(r,t),s=e.array[i];if(s!==void 0){if(s.type!==ce)return Zt(s,t+Me,r,n);if(D(n,s.k))return s}}function Ao(e,t,r,n){let i=er(r,t);if((e.bitmap&i)===0)return;let s=Wr(e.bitmap,i),u=e.array[s];if(u.type!==ce)return Zt(u,t+Me,r,n);if(D(n,u.k))return u}function Bo(e,t){let r=Yr(e,t);if(!(r<0))return e.array[r]}function Xr(e,t,r,n){switch(e.type){case Ie:return Co(e,t,r,n);case _e:return Io(e,t,r,n);case st:return Mo(e,n)}}function Co(e,t,r,n){let i=Tt(r,t),s=e.array[i];if(s===void 0)return e;let u;if(s.type===ce){if(!D(s.k,n))return e}else if(u=Xr(s,t+Me,r,n),u===s)return e;if(u===void 0){if(e.size<=jo){let l=e.array,a=new Array(e.size-1),c=0,p=0,d=0;for(;c<i;){let m=l[c];m!==void 0&&(a[p]=m,d|=1<<c,++p),++c}for(++c;c<l.length;){let m=l[c];m!==void 0&&(a[p]=m,d|=1<<c,++p),++c}return{type:_e,bitmap:d,array:a}}return{type:Ie,size:e.size-1,array:we(e.array,i,u)}}return{type:Ie,size:e.size,array:we(e.array,i,u)}}function Io(e,t,r,n){let i=er(r,t);if((e.bitmap&i)===0)return e;let s=Wr(e.bitmap,i),u=e.array[s];if(u.type!==ce){let l=Xr(u,t+Me,r,n);return l===u?e:l!==void 0?{type:_e,bitmap:e.bitmap,array:we(e.array,s,l)}:e.bitmap===i?void 0:{type:_e,bitmap:e.bitmap^i,array:Fr(e.array,s)}}return D(n,u.k)?e.bitmap===i?void 0:{type:_e,bitmap:e.bitmap^i,array:Fr(e.array,s)}:e}function Mo(e,t){let r=Yr(e,t);if(r<0)return e;if(e.array.length!==1)return{type:st,hash:e.hash,array:Fr(e.array,r)}}function mi(e,t){if(e===void 0)return;let r=e.array,n=r.length;for(let i=0;i<n;i++){let s=r[i];if(s!==void 0){if(s.type===ce){t(s.v,s.k);continue}mi(s,t)}}}var ye=class e{static fromObject(t){let r=Object.keys(t),n=e.new();for(let i=0;i<r.length;i++){let s=r[i];n=n.set(s,t[s])}return n}static fromMap(t){let r=e.new();return t.forEach((n,i)=>{r=r.set(i,n)}),r}static new(){return new e(void 0,0)}constructor(t,r){this.root=t,this.size=r}get(t,r){if(this.root===void 0)return r;let n=Zt(this.root,0,be(t),t);return n===void 0?r:n.v}set(t,r){let n={val:!1},i=this.root===void 0?Hr:this.root,s=At(i,0,be(t),t,r,n);return s===this.root?this:new e(s,n.val?this.size+1:this.size)}delete(t){if(this.root===void 0)return this;let r=Xr(this.root,0,be(t),t);return r===this.root?this:r===void 0?e.new():new e(r,this.size-1)}has(t){return this.root===void 0?!1:Zt(this.root,0,be(t),t)!==void 0}entries(){if(this.root===void 0)return[];let t=[];return this.forEach((r,n)=>t.push([n,r])),t}forEach(t){mi(this.root,t)}hashCode(){let t=0;return this.forEach((r,n)=>{t=t+qr(be(r),be(n))|0}),t}equals(t){if(!(t instanceof e)||this.size!==t.size)return!1;try{return this.forEach((r,n)=>{if(!D(t.get(n,!r),r))throw fi}),!0}catch(r){if(r===fi)return!1;throw r}}},fi=Symbol();var ie=class extends g{constructor(t){super(),this[0]=t}},fe=class extends g{};var J=class extends g{},W=class extends g{},oe=class extends g{};var V=class extends g{},Ne=class extends g{};function Ct(e,t){for(;;){let r=e,n=t;if(r.hasLength(0))return n;{let i=r.head;e=r.tail,t=$(i,n)}}}function U(e){return Ct(e,o([]))}function Ro(e,t,r){for(;;){let n=e,i=t,s=r;if(n.hasLength(0))return U(s);{let u=n.head,l=n.tail,a,c=i(u);if(c.isOk()){let d=c[0];a=$(d,s)}else a=s;let p=a;e=l,t=i,r=p}}}function bi(e,t){return Ro(e,t,o([]))}function qo(e,t,r){for(;;){let n=e,i=t,s=r;if(n.hasLength(0))return U(s);{let u=n.head;e=n.tail,t=i,r=$(i(u),s)}}}function qe(e,t){return qo(e,t,o([]))}function Fo(e,t){for(;;){let r=e,n=t;if(r.hasLength(0))return n;{let i=r.head;e=r.tail,t=$(i,n)}}}function Fe(e,t){return Fo(U(e),t)}function Pe(e,t,r){for(;;){let n=e,i=t,s=r;if(n.hasLength(0))return i;{let u=n.head;e=n.tail,t=s(i,u),r=s}}}function Ko(e,t,r,n,i,s){for(;;){let u=e,l=t,a=r,c=n,p=i,d=s,m=$(p,a);if(u.hasLength(0))return c instanceof V?$(U(m),d):$(m,d);{let x=u.head,_=u.tail,k=l(p,x);if(k instanceof oe&&c instanceof Ne)e=_,t=l,r=m,n=c,i=x,s=d;else if(k instanceof J&&c instanceof V)e=_,t=l,r=m,n=c,i=x,s=d;else if(k instanceof W&&c instanceof V)e=_,t=l,r=m,n=c,i=x,s=d;else if(k instanceof oe&&c instanceof V){let h;c instanceof V?h=$(U(m),d):h=$(m,d);let v=h;if(_.hasLength(0))return $(o([x]),v);{let w=_.head,O=_.tail,y,b=l(x,w);b instanceof J?y=new V:b instanceof W?y=new V:y=new Ne;let j=y;e=O,t=l,r=o([x]),n=j,i=w,s=v}}else if(k instanceof J&&c instanceof Ne){let h;c instanceof V?h=$(U(m),d):h=$(m,d);let v=h;if(_.hasLength(0))return $(o([x]),v);{let w=_.head,O=_.tail,y,b=l(x,w);b instanceof J?y=new V:b instanceof W?y=new V:y=new Ne;let j=y;e=O,t=l,r=o([x]),n=j,i=w,s=v}}else{let h;c instanceof V?h=$(U(m),d):h=$(m,d);let v=h;if(_.hasLength(0))return $(o([x]),v);{let w=_.head,O=_.tail,y,b=l(x,w);b instanceof J?y=new V:b instanceof W?y=new V:y=new Ne;let j=y;e=O,t=l,r=o([x]),n=j,i=w,s=v}}}}}function Go(e,t,r,n){for(;;){let i=e,s=t,u=r,l=n;if(i.hasLength(0))return Ct(s,l);if(s.hasLength(0))return Ct(i,l);{let a=i.head,c=i.tail,p=s.head,d=s.tail,m=u(a,p);m instanceof J?(e=c,t=s,r=u,n=$(a,l)):m instanceof oe?(e=i,t=d,r=u,n=$(p,l)):(e=i,t=d,r=u,n=$(p,l))}}}function Ho(e,t,r){for(;;){let n=e,i=t,s=r;if(n.hasLength(0))return U(s);if(n.hasLength(1)){let u=n.head;return U($(U(u),s))}else{let u=n.head,l=n.tail.head,a=n.tail.tail,c=Go(u,l,i,o([]));e=a,t=i,r=$(c,s)}}}function Wo(e,t,r,n){for(;;){let i=e,s=t,u=r,l=n;if(i.hasLength(0))return Ct(s,l);if(s.hasLength(0))return Ct(i,l);{let a=i.head,c=i.tail,p=s.head,d=s.tail,m=u(a,p);m instanceof J?(e=i,t=d,r=u,n=$(p,l)):m instanceof oe?(e=c,t=s,r=u,n=$(a,l)):(e=c,t=s,r=u,n=$(a,l))}}}function Vo(e,t,r){for(;;){let n=e,i=t,s=r;if(n.hasLength(0))return U(s);if(n.hasLength(1)){let u=n.head;return U($(U(u),s))}else{let u=n.head,l=n.tail.head,a=n.tail.tail,c=Wo(u,l,i,o([]));e=a,t=i,r=$(c,s)}}}function Yo(e,t,r){for(;;){let n=e,i=t,s=r;if(n.hasLength(0))return o([]);if(n.hasLength(1)&&i instanceof V)return n.head;if(n.hasLength(1)&&i instanceof Ne){let u=n.head;return U(u)}else i instanceof V?(e=Ho(n,s,o([])),t=new Ne,r=s):(e=Vo(n,s,o([])),t=new V,r=s)}}function wi(e,t){if(e.hasLength(0))return o([]);if(e.hasLength(1)){let r=e.head;return o([r])}else{let r=e.head,n=e.tail.head,i=e.tail.tail,s,u=t(r,n);u instanceof J?s=new V:u instanceof W?s=new V:s=new Ne;let l=s,a=Ko(i,t,o([r]),l,n,o([]));return Yo(a,new V,t)}}function iu(e,t){for(;;){let r=e,n=t;if(r.atLeastLength(1)){let i=r.head;e=r.tail,t=n+i}else return n}}function yi(e){return iu(e,"")}function ki(e){return!!e.isOk()}function lt(e,t){if(e.isOk()){let r=e[0];return new I(t(r))}else{let r=e[0];return new T(r)}}function tr(e,t){return e.isOk()?e[0]:t}function rr(e){return bi(e,t=>t)}var pu=void 0,ji={};function Re(e){return e.toString()}function Zr(e,t){return e.startsWith(t)}var Li=[" ","	",`
`,"\v","\f","\r","\x85","\u2028","\u2029"].join(""),jc=new RegExp(`^[${Li}]*`),Lc=new RegExp(`[${Li}]*$`);function en(e){console.log(e)}function ot(){return ye.new()}function ve(e,t){let r=e.get(t,ji);return r===ji?new T(pu):new I(r)}function Oi(e,t,r){return r.set(e,t)}function at(e){if(typeof e=="string")return"String";if(typeof e=="boolean")return"Bool";if(e instanceof ht)return"Result";if(e instanceof Se)return"List";if(e instanceof Ce)return"BitArray";if(e instanceof ye)return"Dict";if(Number.isInteger(e))return"Int";if(Array.isArray(e))return`Tuple of ${e.length} elements`;if(typeof e=="number")return"Float";if(e===null)return"Null";if(e===void 0)return"Nil";{let t=typeof e;return t.charAt(0).toUpperCase()+t.slice(1)}}function Xe(e,t,r){return Oi(t,r,e)}function Si(e,t){if(e instanceof ye||e instanceof WeakMap||e instanceof Map){let n={},i=e.get(t,n);return i===n?new I(new fe):new I(new ie(i))}let r=Number.isInteger(t);if(r&&t>=0&&t<8&&e instanceof Se){let n=0;for(let i of e){if(n===t)return new I(new ie(i));n++}return new T("Indexable")}return r&&Array.isArray(e)||e&&typeof e=="object"||e&&Object.getPrototypeOf(e)===Object.prototype?t in e?new I(new ie(e[t])):new I(new fe):new T(r?"Indexable":"Dict")}function Ei(e){return Number.isInteger(e)?new I(e):new T(0)}function Ti(e){return typeof e=="string"?new I(e):new T("")}var Qe=class extends g{constructor(t,r,n){super(),this.expected=t,this.found=r,this.path=n}},Ke=class extends g{constructor(t){super(),this.function=t}};function ct(e,t){let r=t.function(e),n=r[0],i=r[1];return i.hasLength(0)?new I(n):new T(i)}function xt(e){return new Ke(t=>[e,o([])])}function nr(e,t){return new Ke(r=>{let n=e.function(r),i=n[0],s=n[1];return[t(i),s]})}function hu(e,t,r){for(;;){let n=e,i=t,s=r;if(s.hasLength(0))return i;{let u=s.head,l=s.tail,a=u.function(n),c=a;if(a[1].hasLength(0))return c;e=n,t=i,r=l}}}function Bi(e,t){return new Ke(r=>{let n=e.function(r),i=n;return n[1].hasLength(0)?i:hu(r,i,t)})}function _u(e,t){return o([new Qe(e,at(t),o([]))])}function Ci(e,t,r){let n=r(e);return n.isOk()?[n[0],o([])]:[n[0],o([new Qe(t,at(e),o([]))])]}function $u(e){return D(!0,e)?[!0,o([])]:D(!1,e)?[!1,o([])]:[!1,_u("Bool",e)]}function xu(e){return Ci(e,"Int",Ei)}var Ii=new Ke($u),Mi=new Ke(xu);function gu(e){return Ci(e,"String",Ti)}var Mt=new Ke(gu);function tn(e,t){let r=Bi(Mt,o([nr(Mi,Re)])),n=qe(t,s=>{let u=s,l=ct(u,r);return l.isOk()?l[0]:"<"+at(u)+">"}),i=qe(e[1],s=>{let u=s;return new Qe(u.expected,u.found,Fe(n,s.path))});return[e[0],i]}function bu(e,t,r,n,i){for(;;){let s=e,u=t,l=r,a=n,c=i;if(s.hasLength(0)){let p=l(a);return tn(p,U(u))}else{let p=s.head,d=s.tail,m=Si(a,p);if(m.isOk()&&m[0]instanceof ie){let x=m[0][0];e=d,t=$(p,u),r=l,n=x,i=c}else{if(m.isOk()&&m[0]instanceof fe)return c(a,$(p,u));{let x=m[0],h=[l(a)[0],o([new Qe(x,at(a),o([]))])];return tn(h,U(u))}}}}}function ir(e,t,r){return new Ke(n=>{let i=bu(e,o([]),t.function,n,(p,d)=>{let _=[t.function(p)[0],o([new Qe("Field","Nothing",o([]))])];return tn(_,U(d))}),s=i[0],u=i[1],l=r(s).function(n),a=l[0],c=l[1];return[a,Fe(u,c)]})}function Ni(e,t,r){return e?t:r()}function me(e){return e}function nn(e){return e}var or=class extends g{constructor(t){super(),this.dict=t}};function zi(){return new or(ot())}function sn(e,t){let r=e.dict,n=ve(r,t);return ki(n)}var ju=void 0;function Di(e,t){return new or(Xe(e.dict,t,ju))}var Ou=ye.new();function ur(){return Ou}var Su=zi();function Pt(){return Su}var Te=globalThis?.document,lr="http://www.w3.org/1999/xhtml",ar=1,cr=3,zt=11,Ui=!!globalThis.HTMLElement?.prototype?.moveBefore;var E=o([]),fr=new fe;var Eu=new oe,Tu=new J,Au=new W;function dr(e,t){return e.name===t.name?Au:e.name<t.name?Tu:Eu}var je=class extends g{constructor(t,r,n){super(),this.kind=t,this.name=r,this.value=n}},bt=class extends g{constructor(t,r,n){super(),this.kind=t,this.name=r,this.value=n}},le=class extends g{constructor(t,r,n,i,s,u,l,a){super(),this.kind=t,this.name=r,this.handler=n,this.include=i,this.prevent_default=s,this.stop_propagation=u,this.immediate=l,this.limit=a}},wt=class extends g{constructor(t){super(),this.kind=t}},Dt=class extends g{constructor(t,r){super(),this.kind=t,this.delay=r}},Ut=class extends g{constructor(t,r){super(),this.kind=t,this.delay=r}};function Yi(e,t){if(e instanceof wt&&t instanceof wt)return!0;if(e instanceof Dt&&t instanceof Dt&&e.delay===t.delay){let r=e.delay,n=t.delay;return!0}else if(e instanceof Ut&&t instanceof Ut&&e.delay===t.delay){let r=e.delay,n=t.delay;return!0}else return!1}function Mu(e,t){for(;;){let r=e,n=t;if(r.hasLength(0))return n;if(r.atLeastLength(2)&&r.head instanceof je&&r.head.name==="class"&&r.tail.head instanceof je&&r.tail.head.name==="class"){let i=r.head.kind,s=r.head.value,u=r.tail.head.value,l=r.tail.tail,a=s+" "+u,c=new je(i,"class",a);e=$(c,l),t=n}else if(r.atLeastLength(2)&&r.head instanceof je&&r.head.name==="style"&&r.tail.head instanceof je&&r.tail.head.name==="style"){let i=r.head.kind,s=r.head.value,u=r.tail.head.value,l=r.tail.tail,a=s+";"+u,c=new je(i,"style",a);e=$(c,l),t=n}else{let i=r.head;e=r.tail,t=$(i,n)}}}function Xi(e){if(e.hasLength(0))return e;if(e.hasLength(1))return e;{let r=wi(e,(n,i)=>dr(i,n));return Mu(r,E)}}var un=0;function Ji(e,t){return new je(un,e,t)}var ln=1;function Qi(e,t){return new bt(ln,e,t)}var an=2;function Zi(e,t,r,n,i,s,u){return new le(an,e,t,r,n,i,s,u)}var cn=1;var fn=2;function $e(e,t){return Ji(e,t)}function es(e,t){return Qi(e,t)}function Pu(e,t){return t?$e(e,""):es(e,nn(!1))}function Le(e){return $e("class",e)}function ts(e){return $e("id",e)}function zu(e,t){for(;;){let r=e,n=t;if(r.hasLength(0))return n;if(r.atLeastLength(1)&&r.head[0]==="")e=r.tail,t=n;else if(r.atLeastLength(1)&&r.head[1]==="")e=r.tail,t=n;else{let i=r.head[0],s=r.head[1];e=r.tail,t=n+i+":"+s+";"}}}function rs(e){return $e("style",zu(e,""))}function ns(e){return $e("href",e)}function is(e){return Pu("checked",e)}function ss(e){return $e("name",e)}function mr(e){return $e("type",e)}function Ze(e){return $e("value",e)}var pn=class extends g{constructor(t,r,n){super(),this.synchronous=t,this.before_paint=r,this.after_paint=n}};var Du=new pn(o([]),o([]),o([]));function dn(){return Du}function xe(){return null}function yt(e,t){let r=e?.get(t);return r!=null?new I(r):new T(void 0)}function qt(e,t,r){return e??=new Map,e.set(t,r),e}function hn(e,t){return e?.delete(t),e}var _r=class extends g{},$r=class extends g{constructor(t,r){super(),this.key=t,this.parent=r}},_n=class extends g{constructor(t,r){super(),this.index=t,this.parent=r}};function Uu(e,t){for(;;){let r=e,n=t;if(n.hasLength(0))return!1;{let i=n.head,s=n.tail;if(Zr(r,i))return!0;e=r,t=s}}}function et(e,t,r){return r===""?new _n(t,e):new $r(r,e)}var $n=new _r,xn=`
`,gn="	";function us(e,t){for(;;){let r=e,n=t;if(r instanceof _r){if(n.hasLength(0))return"";{let i=n.tail;return yi(i)}}else if(r instanceof $r){let i=r.key;e=r.parent,t=$(gn,$(i,n))}else{let i=r.index;e=r.parent,t=$(xn,$(Re(i),n))}}}function Ru(e){return us(e,o([]))}function ls(e,t){return t.hasLength(0)?!1:Uu(Ru(e),t)}var bn="\f";function wn(e,t){return us(e,o([bn,t]))}var pe=class extends g{constructor(t,r,n,i,s,u){super(),this.kind=t,this.key=r,this.mapper=n,this.children=i,this.keyed_children=s,this.children_count=u}},Oe=class extends g{constructor(t,r,n,i,s,u,l,a,c,p){super(),this.kind=t,this.key=r,this.mapper=n,this.namespace=i,this.tag=s,this.attributes=u,this.children=l,this.keyed_children=a,this.self_closing=c,this.void=p}},ze=class extends g{constructor(t,r,n,i){super(),this.kind=t,this.key=r,this.mapper=n,this.content=i}},Ae=class extends g{constructor(t,r,n,i,s,u,l){super(),this.kind=t,this.key=r,this.mapper=n,this.namespace=i,this.tag=s,this.attributes=u,this.inner_html=l}};function Ku(e,t){return t===""?e==="area"||e==="base"||e==="br"||e==="col"||e==="embed"||e==="hr"||e==="img"||e==="input"||e==="link"||e==="meta"||e==="param"||e==="source"||e==="track"?!0:e==="wbr":!1}function ge(e){return e instanceof pe?1+e.children_count:1}var yn=0;function cs(e,t,r,n,i){return new pe(yn,e,t,r,n,i)}var kn=1;function vn(e,t,r,n,i,s,u,l,a){return new Oe(kn,e,t,r,n,Xi(i),s,u,l,a||Ku(n,r))}var jn=2;function Ln(e,t,r){return new ze(jn,e,t,r)}var fs=3;function ps(e,t,r,n,i){for(;;){let s=e,u=t,l=r,a=n,c=i;if(u.hasLength(0))return[U(a),c];if(u.atLeastLength(1)&&u.head instanceof pe&&u.head.key===""){let p=u.head,d=u.tail,m=s+"::"+Re(l),x=ps(m,p.children,0,E,xe()),_=x[0],k=x[1],h,v=p;h=new pe(v.kind,v.key,v.mapper,_,k,v.children_count);let O=$(h,a),y=l+1;e=s,t=d,r=y,n=O,i=c}else if(u.atLeastLength(1)&&u.head.key!==""){let p=u.head,d=u.tail,m=s+"::"+p.key,x=On(m,p),_=$(x,a),k=qt(c,m,x),h=l+1;e=s,t=d,r=h,n=_,i=k}else{let p=u.head,d=u.tail,m=$(p,a),x=l+1;e=s,t=d,r=x,n=m,i=c}}}function On(e,t){if(t instanceof Oe){let r=t;return new Oe(r.kind,e,r.mapper,r.namespace,r.tag,r.attributes,r.children,r.keyed_children,r.self_closing,r.void)}else if(t instanceof ze){let r=t;return new ze(r.kind,e,r.mapper,r.content)}else if(t instanceof Ae){let r=t;return new Ae(r.kind,e,r.mapper,r.namespace,r.tag,r.attributes,r.inner_html)}else{let r=t.children,n=ps(e,r,0,E,xe()),i=n[0],s=n[1],u=t;return new pe(u.kind,e,u.mapper,i,s,u.children_count)}}var ft=class extends g{constructor(t,r,n,i){super(),this.index=t,this.removed=r,this.changes=n,this.children=i}},Sn=class extends g{constructor(t,r){super(),this.kind=t,this.content=r}},En=class extends g{constructor(t,r){super(),this.kind=t,this.inner_html=r}},Tn=class extends g{constructor(t,r,n){super(),this.kind=t,this.added=r,this.removed=n}},An=class extends g{constructor(t,r,n,i){super(),this.kind=t,this.key=r,this.before=n,this.count=i}},Bn=class extends g{constructor(t,r,n){super(),this.kind=t,this.key=r,this.count=n}},Cn=class extends g{constructor(t,r,n,i){super(),this.kind=t,this.from=r,this.count=n,this.with=i}},In=class extends g{constructor(t,r,n){super(),this.kind=t,this.children=r,this.before=n}},Mn=class extends g{constructor(t,r,n){super(),this.kind=t,this.from=r,this.count=n}};function Nn(e,t,r,n){return new ft(e,t,r,n)}var Pn=0;function ds(e){return new Sn(Pn,e)}var zn=1;function ms(e){return new En(zn,e)}var Dn=2;function Un(e,t){return new Tn(Dn,e,t)}var xr=3;function hs(e,t,r){return new An(xr,e,t,r)}var Rn=4;function _s(e,t){return new Bn(Rn,e,t)}var gr=5;function qn(e,t,r){return new Cn(gr,e,t,r)}var br=6;function Fn(e,t){return new In(br,e,t)}var wr=7;function $s(e,t){return new Mn(wr,e,t)}var jr=class extends g{constructor(t,r){super(),this.patch=t,this.events=r}},Kn=class extends g{constructor(t,r,n){super(),this.added=t,this.removed=r,this.events=n}};function Hu(e,t,r,n){return r==="input"&&t===""?kr(e,n):r==="select"&&t===""?kr(e,n):r==="textarea"&&t===""?kr(e,n):!1}function gs(e,t,r,n,i,s,u,l){for(;;){let a=e,c=t,p=r,d=n,m=i,x=s,_=u,k=l;if(m.hasLength(0)&&x.hasLength(0))return new Kn(_,k,d);if(m.atLeastLength(1)&&m.head instanceof le&&x.hasLength(0)){let h=m.head,v=m.head.name,w=m.tail,O=$(h,k),y=yr(d,c,v);e=a,t=c,r=p,n=y,i=w,s=x,u=_,l=O}else if(m.atLeastLength(1)&&x.hasLength(0)){let h=m.head,v=m.tail,w=$(h,k);e=a,t=c,r=p,n=d,i=v,s=x,u=_,l=w}else if(m.hasLength(0)&&x.atLeastLength(1)&&x.head instanceof le){let h=x.head,v=x.head.name,w=x.head.handler,O=x.tail,y=$(h,_),b=Kt(d,p,c,v,w);e=a,t=c,r=p,n=b,i=m,s=O,u=y,l=k}else if(m.hasLength(0)&&x.atLeastLength(1)){let h=x.head,v=x.tail,w=$(h,_);e=a,t=c,r=p,n=d,i=m,s=v,u=w,l=k}else{let h=m.head,v=m.tail,w=x.head,O=x.tail,y=dr(h,w);if(h instanceof je&&y instanceof W&&w instanceof je){let b,j=w.name;j==="value"||j==="checked"||j==="selected"?b=a||h.value!==w.value:b=h.value!==w.value;let S=b,B;S?B=$(w,_):B=_;let N=B;e=a,t=c,r=p,n=d,i=v,s=O,u=N,l=k}else if(h instanceof bt&&y instanceof W&&w instanceof bt){let b,j=w.name;j==="scrollLeft"||j==="scrollRight"?b=!0:j==="value"?b=a||!D(h.value,w.value):j==="checked"?b=a||!D(h.value,w.value):j==="selected"?b=a||!D(h.value,w.value):b=!D(h.value,w.value);let S=b,B;S?B=$(w,_):B=_;let N=B;e=a,t=c,r=p,n=d,i=v,s=O,u=N,l=k}else if(h instanceof le&&y instanceof W&&w instanceof le){let b=w.name,j=w.handler,S=h.prevent_default!==w.prevent_default||h.stop_propagation!==w.stop_propagation||h.immediate!==w.immediate||!Yi(h.limit,w.limit),B;S?B=$(w,_):B=_;let N=B,z=Kt(d,p,c,b,j);e=a,t=c,r=p,n=z,i=v,s=O,u=N,l=k}else if(h instanceof le&&y instanceof W){let b=h.name,j=$(w,_),S=$(h,k),B=yr(d,c,b);e=a,t=c,r=p,n=B,i=v,s=O,u=j,l=S}else if(y instanceof W&&w instanceof le){let b=w.name,j=w.handler,S=$(w,_),B=$(h,k),N=Kt(d,p,c,b,j);e=a,t=c,r=p,n=N,i=v,s=O,u=S,l=B}else if(y instanceof W){let b=$(w,_),j=$(h,k);e=a,t=c,r=p,n=d,i=v,s=O,u=b,l=j}else if(y instanceof oe&&w instanceof le){let b=w.name,j=w.handler,S=$(w,_),B=Kt(d,p,c,b,j);e=a,t=c,r=p,n=B,i=m,s=O,u=S,l=k}else if(y instanceof oe){let b=$(w,_);e=a,t=c,r=p,n=d,i=m,s=O,u=b,l=k}else if(h instanceof le&&y instanceof J){let b=h.name,j=$(h,k),S=yr(d,c,b);e=a,t=c,r=p,n=S,i=v,s=x,u=_,l=j}else{let b=$(h,k);e=a,t=c,r=p,n=d,i=v,s=x,u=_,l=b}}}}function Gn(e,t,r,n,i,s,u,l,a,c,p,d,m,x){for(;;){let _=e,k=t,h=r,v=n,w=i,O=s,y=u,b=l,j=a,S=c,B=p,N=d,z=m,re=x;if(_.hasLength(0)&&h.hasLength(0))return new jr(new ft(j,y,B,N),re);if(_.atLeastLength(1)&&h.hasLength(0)){let C=_.head,G=_.tail,L;C.key===""||!sn(w,C.key)?L=y+ge(C):L=y;let H=L,Y=Gt(re,S,b,C);e=G,t=k,r=h,n=v,i=w,s=O,u=H,l=b,a=j,c=S,p=B,d=N,m=z,x=Y}else if(_.hasLength(0)&&h.atLeastLength(1)){let C=ws(re,z,S,b,h),G=Fn(h,b-O),L=$(G,B);return new jr(new ft(j,y,L,N),C)}else if(_.atLeastLength(1)&&h.atLeastLength(1)&&_.head.key!==h.head.key){let C=_.head,G=_.tail,L=h.head,ne=h.tail,H=yt(k,L.key),Y=yt(v,C.key),se=sn(w,C.key);if(Y.isOk()&&H.isOk()&&se)e=G,t=k,r=h,n=v,i=w,s=O-ge(C),u=y,l=b,a=j,c=S,p=B,d=N,m=z,x=re;else if(Y.isOk()&&H.isOk()){let P=H[0],M=ge(L),F=b-O,X=hs(L.key,F,M),ee=$(X,B),de=Di(w,L.key),Be=O+M;e=$(P,_),t=k,r=h,n=v,i=de,s=Be,u=y,l=b,a=j,c=S,p=ee,d=N,m=z,x=re}else if(!Y.isOk()&&H.isOk()){let P=ge(C),M=O-P,F=Gt(re,S,b,C),X=_s(C.key,P),ee=$(X,B);e=G,t=k,r=h,n=v,i=w,s=M,u=y,l=b,a=j,c=S,p=ee,d=N,m=z,x=F}else if(Y.isOk()&&!H.isOk()){let P=b-O,M=ge(L),F=vr(re,z,S,b,L),X=Fn(o([L]),P),ee=$(X,B);e=_,t=k,r=ne,n=v,i=w,s=O+M,u=y,l=b+M,a=j,c=S,p=ee,d=N,m=z,x=F}else{let P=ge(C),M=ge(L),F=qn(b-O,P,L),X,de=Gt(re,S,b,C);X=vr(de,z,S,b,L);let Be=X;e=G,t=k,r=ne,n=v,i=w,s=O-P+M,u=y,l=b+M,a=j,c=S,p=$(F,B),d=N,m=z,x=Be}}else if(_.atLeastLength(1)&&_.head instanceof pe&&h.atLeastLength(1)&&h.head instanceof pe){let C=_.head,G=_.tail,L=h.head,ne=h.tail,H=b+1,Y=C.children_count,se=L.children_count,P=tt(z,L.mapper),M=Gn(C.children,C.keyed_children,L.children,L.keyed_children,Pt(),O,0,H,-1,S,E,N,P,re),F;if(M.patch.removed>0){let de=H+se-O,Be=$s(de,M.patch.removed);F=Fe(M.patch.changes,$(Be,B))}else F=Fe(M.patch.changes,B);let ee=F;e=G,t=k,r=ne,n=v,i=w,s=O+se-Y,u=y,l=H+se,a=j,c=S,p=ee,d=M.patch.children,m=z,x=M.events}else if(_.atLeastLength(1)&&_.head instanceof Oe&&h.atLeastLength(1)&&h.head instanceof Oe&&_.head.namespace===h.head.namespace&&_.head.tag===h.head.tag){let C=_.head,G=_.tail,L=h.head,ne=h.tail,H=tt(z,L.mapper),Y=et(S,b,L.key),se=Hu(re,L.namespace,L.tag,Y),P=gs(se,Y,H,re,C.attributes,L.attributes,E,E),M=P.added,F=P.removed,X=P.events,ee;M.hasLength(0)&&F.hasLength(0)?ee=E:ee=o([Un(M,F)]);let de=ee,Be=Gn(C.children,C.keyed_children,L.children,L.keyed_children,Pt(),0,0,0,b,Y,de,E,H,X),mt,Ye=Be.patch;Ye instanceof ft&&Ye.removed===0&&Ye.changes.hasLength(0)&&Ye.children.hasLength(0)?mt=N:mt=$(Be.patch,N);let Nr=mt;e=G,t=k,r=ne,n=v,i=w,s=O,u=y,l=b+1,a=j,c=S,p=B,d=Nr,m=z,x=Be.events}else if(_.atLeastLength(1)&&_.head instanceof ze&&h.atLeastLength(1)&&h.head instanceof ze&&_.head.content===h.head.content){let C=_.head,G=_.tail,L=h.head,ne=h.tail;e=G,t=k,r=ne,n=v,i=w,s=O,u=y,l=b+1,a=j,c=S,p=B,d=N,m=z,x=re}else if(_.atLeastLength(1)&&_.head instanceof ze&&h.atLeastLength(1)&&h.head instanceof ze){let C=_.tail,G=h.head,L=h.tail,ne=Nn(b,0,o([ds(G.content)]),E);e=C,t=k,r=L,n=v,i=w,s=O,u=y,l=b+1,a=j,c=S,p=B,d=$(ne,N),m=z,x=re}else if(_.atLeastLength(1)&&_.head instanceof Ae&&h.atLeastLength(1)&&h.head instanceof Ae){let C=_.head,G=_.tail,L=h.head,ne=h.tail,H=tt(z,L.mapper),Y=et(S,b,L.key),se=gs(!1,Y,H,re,C.attributes,L.attributes,E,E),P=se.added,M=se.removed,F=se.events,X;P.hasLength(0)&&M.hasLength(0)?X=E:X=o([Un(P,M)]);let ee=X,de;C.inner_html===L.inner_html?de=ee:de=$(ms(L.inner_html),ee);let mt=de,Ye;mt.hasLength(0)?Ye=N:Ye=$(Nn(b,0,mt,o([])),N);let Nr=Ye;e=G,t=k,r=ne,n=v,i=w,s=O,u=y,l=b+1,a=j,c=S,p=B,d=Nr,m=z,x=F}else{let C=_.head,G=_.tail,L=h.head,ne=h.tail,H=ge(C),Y=ge(L),se=qn(b-O,H,L),P,F=Gt(re,S,b,C);P=vr(F,z,S,b,L);let X=P;e=G,t=k,r=ne,n=v,i=w,s=O-H+Y,u=y,l=b+Y,a=j,c=S,p=$(se,B),d=N,m=z,x=X}}}function Hn(e,t,r){return Gn(o([t]),xe(),o([r]),xe(),Pt(),0,0,0,0,$n,E,E,me,bs(e))}var Or=class{offset=0;#e=null;#s=()=>{};#l=!1;constructor(t,r,{useServerEvents:n=!1}={}){this.#e=t,this.#s=r,this.#l=n}mount(t){Lr(this.#e,this.#u(t))}#r=[];push(t){let r=this.offset;r&&(He(t.changes,n=>{switch(n.kind){case br:case xr:n.before=(n.before|0)+r;break;case wr:case gr:n.from=(n.from|0)+r;break}}),He(t.children,n=>{n.index=(n.index|0)+r})),this.#r.push({node:this.#e,patch:t}),this.#o()}#o(){let t=this;for(;t.#r.length;){let{node:r,patch:n}=t.#r.pop();He(n.changes,i=>{switch(i.kind){case br:t.#a(r,i.children,i.before);break;case xr:t.#p(r,i.key,i.before,i.count);break;case Rn:t.#d(r,i.key,i.count);break;case wr:t.#t(r,i.from,i.count);break;case gr:t.#c(r,i.from,i.count,i.with);break;case Pn:t.#i(r,i.content);break;case zn:t.#m(r,i.inner_html);break;case Dn:t.#f(r,i.added,i.removed);break}}),n.removed&&t.#t(r,r.childNodes.length-n.removed,n.removed),He(n.children,i=>{t.#r.push({node:Wt(r,i.index),patch:i})})}}#a(t,r,n){let i=vs();He(r,s=>{let u=this.#u(s);Vn(t,u),Lr(i,u)}),Wn(t,i,Wt(t,n))}#p(t,r,n,i){let s=js(t,r),u=Wt(t,n);for(let l=0;l<i&&s!==null;++l){let a=s.nextSibling;Ui?t.moveBefore(s,u):Wn(t,s,u),s=a}}#d(t,r,n){this.#n(t,js(t,r),n)}#t(t,r,n){this.#n(t,Wt(t,r),n)}#n(t,r,n){for(;n-- >0&&r!==null;){let i=r.nextSibling,s=r[te].key;s&&t[te].keyedChildren.delete(s);for(let[u,{timeout:l}]of r[te].debouncers)clearTimeout(l);t.removeChild(r),r=i}}#c(t,r,n,i){this.#t(t,r,n);let s=this.#u(i);Vn(t,s),Wn(t,s,Wt(t,r))}#i(t,r){t.data=r??""}#m(t,r){t.innerHTML=r??""}#f(t,r,n){He(n,i=>{let s=i.name;t[te].handlers.has(s)?(t.removeEventListener(s,Ls),t[te].handlers.delete(s),t[te].throttles.has(s)&&t[te].throttles.delete(s),t[te].debouncers.has(s)&&(clearTimeout(t[te].debouncers.get(s).timeout),t[te].debouncers.delete(s))):(t.removeAttribute(s),Ss[s]?.removed?.(t,s))}),He(r,i=>{this.#_(t,i)})}#u(t){switch(t.kind){case kn:{let r=ys(t);return this.#h(r,t),this.#a(r,t.children,0),r}case jn:{let r=ks(t.content);return We(r,t.key),r}case yn:{let r=vs(),n=ks();return We(n,t.key),Lr(r,n),He(t.children,i=>{Lr(r,this.#u(i))}),r}case fs:{let r=ys(t);return this.#h(r,t),this.#m(r,t.inner_html),r}}}#h(t,{attributes:r}){He(r,n=>this.#_(t,n))}#_(t,r){let n=t[te];switch(r.kind){case un:{let i=r.name,s=r.value??"";s!==t.getAttribute(i)&&t.setAttribute(i,s),Ss[i]?.added?.(t,s);break}case ln:t[r.name]=r.value;break;case an:{n.handlers.has(r.name)||t.addEventListener(r.name,Ls,{passive:!r.prevent_default});let i=r.prevent_default,s=r.stop_propagation,u=r.immediate,l=Array.isArray(r.include)?r.include:[];if(r.limit?.kind===fn){let a=n.throttles.get(r.name)??{last:0,delay:r.limit.delay};n.throttles.set(r.name,a)}if(r.limit?.kind===cn){let a=n.debouncers.get(r.name)??{timeout:null,delay:r.limit.delay};n.debouncers.set(r.name,a)}n.handlers.set(r.name,a=>{i&&a.preventDefault(),s&&a.stopPropagation();let c=a.type,p="",d=a.currentTarget;for(;d!==this.#e;){let x=d[te].key,_=d.parentNode;if(x)p=`${gn}${x}${p}`;else{let k=_.childNodes,h=[].indexOf.call(k,d);_===this.#e&&(h-=this.offset),p=`${xn}${h}${p}`}d=_}p=p.slice(1);let m=this.#l?Wu(a,l):a;if(n.throttles.has(c)){let x=n.throttles.get(c),_=Date.now(),k=x.last||0;_>k+x.delay?(x.last=_,this.#s(m,p,c,u)):a.preventDefault()}else if(n.debouncers.has(c)){let x=n.debouncers.get(c);clearTimeout(x.timeout),x.timeout=setTimeout(()=>{this.#s(m,p,c,u)},x.delay)}else this.#s(m,p,c,u)});break}}}},He=(e,t)=>{if(Array.isArray(e))for(let r=0;r<e.length;r++)t(e[r]);else if(e)for(e;e.tail;e=e.tail)t(e.head)},Lr=(e,t)=>e.appendChild(t),Wn=(e,t,r)=>e.insertBefore(t,r??null),ys=({key:e,tag:t,namespace:r})=>{let n=Te.createElementNS(r||lr,t);return We(n,e),n},ks=e=>Te.createTextNode(e??""),vs=()=>Te.createDocumentFragment(),Wt=(e,t)=>e.childNodes[t|0],te=Symbol("lustre"),We=(e,t="")=>{switch(e.nodeType){case ar:case zt:e[te]={key:t,keyedChildren:new Map,handlers:new Map,throttles:new Map,debouncers:new Map};break;case cr:e[te]={key:t,debouncers:new Map};break}};var Vn=(e,t)=>{if(t.nodeType===zt){for(t=t.firstChild;t;t=t.nextSibling)Vn(e,t);return}let r=t[te].key;r&&e[te].keyedChildren.set(r,new WeakRef(t))},js=(e,t)=>e[te].keyedChildren.get(t).deref(),Ls=e=>{let r=e.currentTarget[te].handlers.get(e.type);e.type==="submit"&&(e.detail??={},e.detail.formData=[...new FormData(e.target).entries()]),r(e)},Wu=(e,t=[])=>{let r={};(e.type==="input"||e.type==="change")&&t.push("target.value"),e.type==="submit"&&t.push("detail.formData");for(let n of t){let i=n.split(".");for(let s=0,u=e,l=r;s<i.length;s++){if(s===i.length-1){l[i[s]]=u[i[s]];break}l=l[i[s]]??={},u=u[i[s]]}}return r},Os=e=>({added(t){t[e]=!0},removed(t){t[e]=!1}}),Vu=e=>({added(t,r){t[e]=r}}),Ss={checked:Os("checked"),selected:Os("selected"),value:Vu("value"),autofocus:{added(e){queueMicrotask(()=>e.focus?.())}},autoplay:{added(e){try{e.play?.()}catch(t){console.error(t)}}}};var As=e=>{let t=Bs(e);if(t===null||t.children instanceof Ee){let r=Es();return We(r),e.appendChild(r),Cs()}else{if(t.children instanceof he&&t.children.tail instanceof Ee)return t.children.head;{let r=Es();return We(r),e.insertBefore(r,e.firstChild),Xn(t.children)}}},Es=()=>Te.createTextNode(""),Bs=e=>{switch(e.nodeType){case ar:{let t=e.getAttribute("data-lustre-key");We(e,t),t&&e.removeAttribute("data-lustre-key");let r=e.localName,n=e.namespaceURI,i=!n||n===lr;i&&Yu.includes(r)&&Xu(r,e);let s=Ju(e),u=Ts(e),l=i?K(r,s,u):Yn(n,r,s,u);return t?On(t,l):l}case cr:return We(e),Vt(e.data);case zt:return We(e),e.childNodes.length>0?Xn(Ts(e)):null;default:return null}},Yu=["input","select","textarea"],Xu=(e,t)=>{let r=t.value,n=t.checked;e==="input"&&t.type==="checkbox"&&!n||e==="input"&&t.type==="radio"&&!n||t.type!=="checkbox"&&t.type!=="radio"&&!r||queueMicrotask(()=>{t.value=r,t.checked=n,t.dispatchEvent(new Event("input",{bubbles:!0})),t.dispatchEvent(new Event("change",{bubbles:!0})),Te.activeElement!==t&&t.dispatchEvent(new Event("blur",{bubbles:!0}))})},Ts=e=>{let t=E,r=e.lastChild;for(;r;){let n=Bs(r),i=r.previousSibling;n?t=new he(n,t):e.removeChild(r),r=i}return t},Ju=e=>{let t=e.attributes.length,r=E;for(;t-- >0;)r=new he(Qu(e.attributes[t]),r);return r},Qu=e=>{let t=e.localName,r=e.value;return $e(t,r)};var Xt=()=>!!Te;var Jn=(e,t)=>e===t;var Yt=class{constructor(t,[r,n],i,s){this.root=t,this.#e=r,this.#s=i,this.#l=s,this.#a=new Or(this.root,(u,l,a)=>{let[c,p]=Sr(this.#o,l,a,u);this.#o=c,p.isOk()&&this.dispatch(p[0],!1)}),this.#r=As(this.root),this.#o=Qn(),this.#i=!0,this.#f(n)}root=null;set offset(t){this.#a.offset=t}dispatch(t,r=!1){if(this.#i||=r,this.#p)this.#d.push(t);else{let[n,i]=this.#l(this.#e,t);this.#e=n,this.#f(i)}}emit(t,r){(this.root.host??this.root).dispatchEvent(new CustomEvent(t,{detail:r,bubbles:!0,composed:!0}))}#e;#s;#l;#r;#o;#a;#p=!1;#d=[];#t=E;#n=E;#c=null;#i=!1;#m={dispatch:(t,r)=>this.dispatch(t,r),emit:(t,r)=>this.emit(t,r),select:()=>{},root:()=>this.root};#f(t){for(this.#p=!0;;){for(let r=t.synchronous;r.tail;r=r.tail)r.head(this.#m);if(this.#t=Ms(this.#t,t.before_paint),this.#n=Ms(this.#n,t.after_paint),!this.#d.length)break;[this.#e,t]=this.#l(this.#e,this.#d.shift())}this.#p=!1,this.#i?(cancelAnimationFrame(this.#c),this.#u()):this.#c||(this.#c=requestAnimationFrame(()=>{this.#u()}))}#u(){this.#i=!1,this.#c=null;let t=this.#s(this.#e),{patch:r,events:n}=Hn(this.#o,this.#r,t);if(this.#o=n,this.#r=t,this.#a.push(r),this.#t instanceof he){let i=Is(this.#t);this.#t=E,queueMicrotask(()=>{this.#i=!0,this.#f(i)})}if(this.#n instanceof he){let i=Is(this.#n);this.#n=E,requestAnimationFrame(()=>{this.#i=!0,this.#f(i)})}}};function Is(e){return{synchronous:e,after_paint:E,before_paint:E}}function Ms(e,t){return e instanceof Ee?t:t instanceof Ee?e:Fe(e,t)}var De=class extends g{constructor(t,r,n){super(),this.handlers=t,this.dispatched_paths=r,this.next_dispatched_paths=n}};function Qn(){return new De(xe(),E,E)}function bs(e){return new De(e.handlers,e.next_dispatched_paths,E)}function Ds(e,t,r){return hn(e,wn(t,r))}function yr(e,t,r){let n=Ds(e.handlers,t,r),i=e;return new De(n,i.dispatched_paths,i.next_dispatched_paths)}function Ns(e,t,r){return Pe(r,e,(n,i)=>{if(i instanceof le){let s=i.name;return Ds(n,t,s)}else return n})}function Sr(e,t,r,n){let i=$(t,e.next_dispatched_paths),s,u=e;s=new De(u.handlers,u.dispatched_paths,i);let l=s,a=yt(l.handlers,t+bn+r);if(a.isOk()){let c=a[0];return[l,ct(n,c)]}else return[l,new T(o([]))]}function kr(e,t){return ls(t,e.dispatched_paths)}function Us(e,t,r,n,i){return qt(e,wn(r,n),nr(i,t))}function Kt(e,t,r,n,i){let s=Us(e.handlers,t,r,n,i),u=e;return new De(s,u.dispatched_paths,u.next_dispatched_paths)}function Ps(e,t,r,n){return Pe(n,e,(i,s)=>{if(s instanceof le){let u=s.name,l=s.handler;return Us(i,t,r,u,l)}else return i})}function tt(e,t){let r=Jn(e,me),n=Jn(t,me);return n?e:r&&!n?t:i=>e(t(i))}function zs(e,t,r,n){for(;;){let i=e,s=t,u=r,l=n;if(l.hasLength(0))return i;{let a=l.head,c=l.tail;e=Rs(i,s,u,a),t=s,r=u+ge(a),n=c}}}function Rs(e,t,r,n){if(n instanceof Oe){let i=n.attributes,s=n.children,u=et(t,r,n.key),a=Ns(e,u,i);return zs(a,u,0,s)}else if(n instanceof pe){let i=n.children;return zs(e,t,r+1,i)}else if(n instanceof Ae){let i=n.attributes,s=et(t,r,n.key);return Ns(e,s,i)}else return e}function Gt(e,t,r,n){let i=Rs(e.handlers,t,r,n),s=e;return new De(i,s.dispatched_paths,s.next_dispatched_paths)}function Zn(e,t,r,n,i){for(;;){let s=e,u=t,l=r,a=n,c=i;if(c.hasLength(0))return s;{let p=c.head,d=c.tail;e=qs(s,u,l,a,p),t=u,r=l,n=a+ge(p),i=d}}}function qs(e,t,r,n,i){if(i instanceof Oe){let s=i.attributes,u=i.children,l=et(r,n,i.key),a=tt(t,i.mapper),p=Ps(e,a,l,s);return Zn(p,a,l,0,u)}else if(i instanceof pe){let s=i.children,u=tt(t,i.mapper),l=n+1;return Zn(e,u,r,l,s)}else if(i instanceof Ae){let s=i.attributes,u=et(r,n,i.key),l=tt(t,i.mapper);return Ps(e,l,u,s)}else return e}function vr(e,t,r,n,i){let s=qs(e.handlers,t,r,n,i),u=e;return new De(s,u.dispatched_paths,u.next_dispatched_paths)}function ws(e,t,r,n,i){let s=Zn(e.handlers,t,r,n,i),u=e;return new De(s,u.dispatched_paths,u.next_dispatched_paths)}function K(e,t,r){return vn("",me,"",e,t,r,xe(),!1,!1)}function Yn(e,t,r,n){return vn("",me,e,t,r,n,xe(),!1,!1)}function Vt(e){return Ln("",me,e)}function Cs(){return Ln("",me,"")}function Zu(e,t){for(;;){let r=e,n=t;if(r.hasLength(0))return n;if(r.atLeastLength(1)&&r.head instanceof pe){let i=r.head.children_count;e=r.tail,t=n+i}else e=r.tail,t=n+1}}function Xn(e){return cs("",me,e,xe(),Zu(e,0))}function f(e){return Vt(e)}function Fs(e,t){return K("h1",e,t)}function Ue(e,t){return K("h3",e,t)}function ei(e,t){return K("h4",e,t)}function Q(e,t){return K("div",e,t)}function ae(e,t){return K("li",e,t)}function R(e,t){return K("p",e,t)}function rt(e,t){return K("ul",e,t)}function Ks(e,t){return K("a",e,t)}function ti(e){return K("br",e,E)}function Gs(e,t){return K("code",e,t)}function nt(e,t){return K("em",e,t)}function Hs(e,t){return K("samp",e,t)}function Er(e){return K("input",e,E)}function Jt(e,t){return K("label",e,t)}function kt(e,t){return K("option",e,o([Vt(t)]))}function Ws(e,t){return K("select",e,t)}function Vs(e,t){return K("details",e,t)}function Ys(e,t){return K("summary",e,t)}var pt=class extends g{constructor(t){super(),this.message=t}},vt=class extends g{constructor(t,r){super(),this.name=t,this.data=r}};var dt=class extends g{};var ri=class extends g{constructor(t,r,n,i,s,u,l,a){super(),this.open_shadow_root=t,this.adopt_styles=r,this.attributes=n,this.properties=i,this.is_form_associated=s,this.on_form_autofill=u,this.on_form_reset=l,this.on_form_restore=a}};function Qs(e){let t=new ri(!1,!0,ur(),ur(),!1,fr,fr,fr);return Pe(e,t,(r,n)=>n.apply(r))}var ni=class e{static start({init:t,update:r,view:n},i,s){if(!Xt())return new T(new jt);let u=i instanceof HTMLElement?i:Te.querySelector(i);return u?new I(new e(u,t(s),r,n)):new T(new Tr(i))}#e;constructor(t,[r,n],i,s){this.#e=new Yt(t,[r,n],s,i)}send(t){switch(t.constructor){case pt:{this.dispatch(t.message,!1);break}case vt:{this.emit(t.name,t.data);break}case dt:break}}dispatch(t,r){this.#e.dispatch(t,r)}emit(t,r){this.#e.emit(t,r)}},Zs=ni.start;var ii=class extends g{constructor(t,r,n,i){super(),this.init=t,this.update=r,this.view=n,this.config=i}};var Tr=class extends g{constructor(t){super(),this.selector=t}},jt=class extends g{};function ul(e,t,r){return new ii(e,t,r,Qs(E))}function eo(e,t,r){return ul(s=>[e(s),dn()],(s,u)=>[t(s,u),dn()],r)}function to(e,t,r){return Ni(!Xt(),new T(new jt),()=>Zs(e,t,r))}function al(e){return e==="input"||e==="change"||e==="focus"||e==="focusin"||e==="focusout"||e==="blur"?!0:e==="select"}function Ar(e,t){return Zi(e,t,E,!1,!1,al(e),new wt(0))}function ro(e){return Ar("click",xt(e))}function no(e){return Ar("input",ir(o(["target","value"]),Mt,t=>xt(e(t))))}function io(e){return Ar("change",ir(o(["target","value"]),Mt,t=>xt(e(t))))}function so(e){return Ar("change",ir(o(["target","checked"]),Ii,t=>xt(e(t))))}var it=class extends g{constructor(t,r,n,i){super(),this.format=t,this.show_defaults=r,this.entries=n,this.keys=i}},Br=class extends g{constructor(t,r,n,i){super(),this.id=t,this.name=r,this.default=n,this.value=i}},Cr=class extends g{constructor(t){super(),this.to=t}},Ir=class extends g{constructor(t){super(),this.to=t}},Mr=class extends g{constructor(t,r){super(),this.of=t,this.to=r}};function fl(e){let t=(M,F,X,ee)=>{let de=M;return new it(de.format,de.show_defaults,Xe(M.entries,F,new Br(F,X,ee,ee)),$(F,M.keys))},r,n=new it("BashExport",!1,ot(),o([])),i=t(n,"logLevel","INBUCKET_LOGLEVEL","info"),s=t(i,"mailboxNaming","INBUCKET_MAILBOXNAMING","local"),u=t(s,"smtp.addr","INBUCKET_SMTP_ADDR","0.0.0.0:2500"),l=t(u,"smtp.domain","INBUCKET_SMTP_DOMAIN","inbucket"),a=t(l,"smtp.maxRecipients","INBUCKET_SMTP_MAXRECIPIENTS","200"),c=t(a,"smtp.maxMessageBytes","INBUCKET_SMTP_MAXMESSAGEBYTES","10240000"),p=t(c,"smtp.defaultAccept","INBUCKET_SMTP_DEFAULTACCEPT","true"),d=t(p,"smtp.acceptDomains","INBUCKET_SMTP_ACCEPTDOMAINS",""),m=t(d,"smtp.rejectDomains","INBUCKET_SMTP_REJECTDOMAINS",""),x=t(m,"smtp.defaultStore","INBUCKET_SMTP_DEFAULTSTORE","true"),_=t(x,"smtp.storeDomains","INBUCKET_SMTP_STOREDOMAINS",""),k=t(_,"smtp.discardDomains","INBUCKET_SMTP_DISCARDDOMAINS",""),h=t(k,"smtp.timeout","INBUCKET_SMTP_TIMEOUT","300s"),v=t(h,"smtp.tlsEnabled","INBUCKET_SMTP_TLSENABLED","false"),w=t(v,"smtp.tlsPrivKey","INBUCKET_SMTP_TLSPRIVKEY","cert.key"),O=t(w,"smtp.tlsCert","INBUCKET_SMTP_TLSCERT","cert.crt"),y=t(O,"pop3.addr","INBUCKET_POP3_ADDR","0.0.0.0:1100"),b=t(y,"pop3.domain","INBUCKET_POP3_DOMAIN","inbucket"),j=t(b,"pop3.timeout","INBUCKET_POP3_TIMEOUT","600s"),S=t(j,"web.addr","INBUCKET_WEB_ADDR","0.0.0.0:9000"),B=t(S,"web.basePath","INBUCKET_WEB_BASEPATH",""),N=t(B,"web.uiDir","INBUCKET_WEB_UIDIR","ui/dist"),z=t(N,"web.greetingFile","INBUCKET_WEB_GREETINGFILE","ui/greeting.html"),re=t(z,"web.monitorVisible","INBUCKET_WEB_MONITORVISIBLE","true"),C=t(re,"web.monitorHistory","INBUCKET_WEB_MONITORHISTORY","30"),G=t(C,"web.pprof","INBUCKET_WEB_PPROF","false"),L=t(G,"storage.type","INBUCKET_STORAGE_TYPE","memory"),ne=t(L,"storage.params","INBUCKET_STORAGE_PARAMS",""),H=t(ne,"storage.retentionPeriod","INBUCKET_STORAGE_RETENTIONPERIOD","24h"),Y=t(H,"storage.retentionSleep","INBUCKET_STORAGE_RETENTIONSLEEP","50ms");r=t(Y,"storage.mailboxMsgCap","INBUCKET_STORAGE_MAILBOXMSGCAP","500");let se=r,P=se;return new it(P.format,P.show_defaults,P.entries,U(se.keys))}function pl(e,t){if(_l(t,"src/configurator.gleam",105),t instanceof Cr){let r=t.to,n=e;return new it(r,n.show_defaults,n.entries,n.keys)}else if(t instanceof Ir){let r=t.to,n=e;return new it(n.format,r,n.entries,n.keys)}else{let r=t.of,n=t.to,i,s=ve(e.entries,r),u=lt(s,c=>Xe(e.entries,r,(()=>{let p=c;return new Br(p.id,p.name,p.default,n)})()));i=tr(u,e.entries);let l=i,a=e;return new it(a.format,a.show_defaults,l,a.keys)}}function A(e){return Gs(o([]),o([f(e)]))}function Lt(e,t){return Vs(o([$e("open","true")]),$(Ys(o([Le("section")]),o([f(e)])),t))}function dl(e,t,r){let n;{let s;t==="BashExport"?s="export "+r.name+'="'+r.value+'"':t==="DockerCompose"?s=r.name+': "'+r.value+'"':t==="DockerShell"?s="-e "+r.name+'="'+r.value+'"':t==="Systemd"?s="Environment="+r.name+"="+r.value:t==="KubernetesConfigMap"?s="  "+r.name+': "'+r.value+'"':s="Unknown format: "+t;let u=s;n=Q(o([Le("env-line")]),o([f(u)]))}let i=n;return!e&&r.value===r.default?new T(void 0):e?new I(i):new I(i)}function ml(e){let t=qe(e.keys,n=>lt(ve(e.entries,n),i=>dl(e.show_defaults,e.format,i))),r=rr(t);return rr(r)}function Ot(e,t,r){let n=ve(e,t);return n.isOk()?n[0].value===r:!1}function Z(e,t,r,n){let i,s=ve(e,t),u=lt(s,a=>a.value===r);i=tr(u,!1);let l=i;return Q(o([]),o([Jt(o([]),$(Er(o([ss(t),Ze(r),mr("radio"),is(l),ro(new Mr(t,r))])),$(Hs(o([]),o([f(r)])),$(f(": "),n))))]))}function q(e,t,r,n,i,s){let u,l=ve(e,t),a=lt(l,m=>m.value);u=tr(a,"");let c=u,p;i?p=o([]):p=o([["display","none"]]);let d=p;return Q(o([Le("config-item"),rs(d)]),o([Ue(o([]),o([f(n)])),R(o([]),s),Jt(o([]),o([Er(o([mr("text"),Ze(c),no(m=>new Mr(t,m))])),f(" "),f(r)]))]))}function hl(e){let t=e.entries;return Q(o([]),o([Fs(o([]),o([f("Inbucket Configurator")])),Q(o([ts("config-form")]),o([Lt("Global",o([Q(o([Le("config-item")]),o([Ue(o([]),o([f("Log Level")])),R(o([]),o([f(` This setting controls the verbosity of log output. A small desktop installation should
          probably select info, but a busy shared installation would be better off with warn or error. `)])),Z(t,"logLevel","error",o([f("output errors only")])),Z(t,"logLevel","warn",o([f("output errors, and warnings")])),Z(t,"logLevel","info",o([f("output errors, warnings, and informational messages")])),Z(t,"logLevel","debug",o([f("output everything, including debugging information")]))])),Q(o([Le("config-item")]),o([Ue(o([]),o([f("Mailbox Naming")])),R(o([]),o([f(`The mailbox naming setting determines the name of a mailbox for an incoming
        message, and thus where it must be retrieved from later.`)])),Z(t,"mailboxNaming","local",o([f("ensures the domain is removed, such that:"),rt(o([]),o([ae(o([]),o([A("james@inbucket.org"),f(" is stored in "),A("james")])),ae(o([]),o([A("james+spam@inbucket.org"),f(" is stored in "),A("james")]))]))])),Z(t,"mailboxNaming","full",o([f("retains the domain as part of the name, such that:"),rt(o([]),o([ae(o([]),o([A("james@inbucket.org"),f(" is stored in "),A("james@inbucket.org")])),ae(o([]),o([A("james+spam@inbucket.org"),f(" is stored in "),A("james@inbucket.org")]))]))])),Z(t,"mailboxNaming","domain",o([f("ensures the local-part is removed, such that:"),rt(o([]),o([ae(o([]),o([A("james@inbucket.org"),f(" is stored in "),A("inbucket.org")])),ae(o([]),o([A("matt@inbucket.org"),f(" is stored in "),A("inbucket.org")])),ae(o([]),o([A("matt@noinbucket.com"),f(" is stored in "),A("notinbucket.com")]))]))]))]))])),Lt("SMTP",o([q(t,"smtp.addr","address:port","Address and Port",!0,o([f(` The IPv4 address and TCP port number the SMTP server should listen on, separated by a colon.
      Some operating systems may prevent Inbucket from listening on port 25 without escalated
      privileges.  Using an IP address of 0.0.0.0 will cause Inbucket to listen on all available
      network interfaces. `)])),q(e.entries,"smtp.domain","host or domain name","Greeting Domain",!0,o([f(" The domain used in the SMTP greeting: "),A("220 domain Inbucket SMTP ready"),f(`.  Most SMTP
      clients appear to ignore this value. `)])),q(e.entries,"smtp.maxRecipients","positive integer","Maximum Recipients",!0,o([f(" Maximum number of recipients allowed (SMTP "),A("RCPT TO"),f(` phase).  If you are testing
      a mailing list server, you may need to increase this value.  For comparison, the
      Postfix SMTP server uses a default of 1000, it would be unwise to exceed this. `)])),q(e.entries,"smtp.maxMessageBytes","positive integer bytes","Maximum Message Size",!0,o([f(` Maximum allowable size of a message (including headers) in bytes.  Messages
      exceeding this size will be rejected during the SMTP `),A("DATA"),f(" phase. ")])),Q(o([Le("config-item")]),o([Ue(o([]),o([f("Default Recipient Accept Policy")])),Z(t,"smtp.defaultAccept","true",o([f("accept mail to any domain unless present in the reject domains list.")])),Z(t,"smtp.defaultAccept","false",o([f("recipients will be rejected unless their domain is present in the accept domains list.")]))])),q(e.entries,"smtp.acceptDomains","comma separated domains","Accepted Recipient Domain List",Ot(t,"smtp.defaultAccept","false"),o([f(" List of domains to accept mail for when "),nt(o([]),o([f("Default Recipient Accept Policy")])),f(" is false; has no effect when true. ")])),q(e.entries,"smtp.rejectDomains","comma separated domains","Rejected Recipient Domain List",Ot(t,"smtp.defaultAccept","true"),o([f(" List of domains to reject mail for when "),nt(o([]),o([f("Default Recipient Accept Policy")])),f(" is true; has no effect when false. ")])),Q(o([Le("config-item")]),o([Ue(o([]),o([f("Default Recipient Store Policy")])),Z(t,"smtp.defaultStore","true",o([f("store mail sent to any domain unless present in the discard domains list.")])),Z(t,"smtp.defaultStore","false",o([f("messages will be discarded unless their domain is present in the store domains list.")]))])),q(e.entries,"smtp.storeDomains","comma separated domains","Stored Recipient Domain List",Ot(t,"smtp.defaultStore","false"),o([f(" List of domains to store mail for when "),nt(o([]),o([f("Default Recipient Store Policy")])),f(` is false;
      has no effect when true. `)])),q(e.entries,"smtp.discardDomains","comma separated domains","Discarded Recipient Domain List",Ot(t,"smtp.defaultStore","true"),o([f(` Mail sent to these domains will not be stored by Inbucket.  This is helpful if
      you are load or soak testing a service, and do not plan to inspect the resulting
      emails.  Messages sent to a domain other than this will be stored normally.
      Only has an effect when `),nt(o([]),o([f("Default Recipient Store Policy")])),f(" is true. ")])),q(e.entries,"smtp.timeout","duration ending in s for seconds, m for minutes","Network Idle Timeout",!0,o([f(` Delay before closing an idle SMTP connection.  The SMTP RFC recommends 300
      seconds.  Consider reducing this *significantly* if you plan to expose Inbucket
      to the public internet. `)])),Q(o([Le("config-item")]),o([Ue(o([]),o([f("TLS Encryption Availability")])),Z(t,"smtp.tlsEnabled","true",o([f("SMTP STARTTLS will be availble for opportunistic TLS. ")])),Z(t,"smtp.tlsEnabled","false",o([f("TLS encryption will be disabled. ")]))])),q(e.entries,"smtp.tlsPrivKey","filename or path to private key","TLS Private Key File",Ot(t,"smtp.tlsEnabled","true"),o([f(" Specify the x509 Private key file to be used for TLS negotiation. ")])),q(e.entries,"smtp.tlsCert","filename or path to the certificate key","TLS Public Certificate File",Ot(t,"smtp.tlsEnabled","true"),o([f(" Specify the x509 Certificate file to be used for TLS negotiation. ")]))])),Lt("POP3",o([q(e.entries,"pop3.addr","address:port","Address and Port",!0,o([f(` The IPv4 address and TCP port number the POP3 server should listen on, separated
      by a colon.  Some operating systems may prevent Inbucket from listening on port
      110 without escalated privileges.  Using an IP address of 0.0.0.0 will cause
      Inbucket to listen on all available network interfaces. `)])),q(e.entries,"pop3.domain","host or domain name","Greeting Domain",!0,o([R(o([]),o([f("The domain used in the POP3 greeting:")])),A("+OK Inbucket POP3 server ready <26641.1522000423@domain>"),R(o([]),o([f("Most POP3 clients appear to ignore this value.")]))])),q(e.entries,"pop3.timeout","duration ending in s for seconds, m for minutes","Network Idle Timeout",!0,o([f(` Delay before closing an idle POP3 connection.  The POP3 RFC recommends 600
      seconds.  Consider reducing this `),nt(o([]),o([f("significantly")])),f(" if you plan to expose Inbucket to the public internet. ")]))])),Lt("Web",o([q(e.entries,"web.addr","address:port","Address and Port",!0,o([f(` The IPv4 address and TCP port number the HTTP server should listen on, separated
    by a colon.  Some operating systems may prevent Inbucket from listening on port
    80 without escalated privileges.  Using an IP address of 0.0.0.0 will cause
    Inbucket to listen on all available network interfaces. `)])),q(e.entries,"web.basePath","empty or URI prefix","Base Path",!0,o([R(o([]),o([f(`Base path prefix for UI and API URLs.  This option is used when you wish to
    root all Inbucket URLs to a specific path when placing it behind a
    reverse-proxy.`)])),R(o([]),o([f(" For example, setting the base path to "),A("prefix"),f(" will move:")])),rt(o([]),o([ae(o([]),o([f("the Inbucket status page from "),A("/status"),f(" to "),A("/prefix/status"),f(",")])),ae(o([]),o([f("Bob's mailbox from "),A("/m/bob"),f(" to "),A("/prefix/m/bob"),f(", and")])),ae(o([]),o([f("the REST API from "),A("/api/v1/*"),f(" to "),A("/prefix/api/v1/*"),f(".")]))])),R(o([]),o([]))])),q(e.entries,"web.uiDir","OS directory path","UI Directory",!0,o([R(o([]),o([f(`This directory contains the static assets for the web user
                interface.  This value can vary significantly with different
                installation methods, for example:`)])),rt(o([]),o([ae(o([]),o([A("ui"),f(" for Docker")])),ae(o([]),o([A("/usr/share/inbucket/ui"),f(" for RPM and debian packages")])),ae(o([]),o([A("ui/dist"),f(" when built from source")]))]))])),q(e.entries,"web.greetingFile","OS file path","Greeting HTML File",!0,o([f(` The content of the greeting file will be injected into the front page of
    Inbucket.  It can be used to instruct users on how to send mail into your
    Inbucket installation, as well as link to REST documentation, etc. `)])),Q(o([Le("config-item")]),o([Ue(o([]),o([f("Monitor Visible")])),Z(e.entries,"web.monitorVisible","true",o([f(`the monitor tab will be available, allowing users to observe all
      messages received by Inbucket as they arrive. `)])),Z(e.entries,"web.monitorVisible","false",o([f("the monitor will be hidden. ")])),R(o([]),o([f(`This setting has no impact on the availability of the underlying WebSocket,
      which may be used by other parts of the Inbucket interface or continuous
      integration tests.`)]))])),q(e.entries,"web.monitorHistory","positive integer","Monitor History",!0,o([R(o([]),o([f("The number of messages to remember on the "),nt(o([]),o([f("server")])),f(" for new Monitor clients. Does not impact the amount of "),nt(o([]),o([f("new")])),f(` messages displayed by the Monitor.
    Increasing this has no appreciable impact on memory use, but may slow down the
    Monitor user interface.`)])),R(o([]),o([f("This setting also impacts the number of messages available via WebSocket.")])),R(o([]),o([f(`Setting to 0 will disable the monitor, but will probably break new mail
    notifications in the web interface when I finally get around to implementing
    them.`)]))])),Q(o([Le("config-item")]),o([Ue(o([]),o([f("Expose Profiling Data")])),R(o([]),o([f(" If enabled, Go's pprof package will be installed to the "),A("/debug/pprof"),f(` URI.  This
        exposes detailed memory and CPU performance data for debugging Inbucket.  If you enable this
        option, please make sure it is not exposed to the public internet, as its use can
        significantly impact performance. `)])),Z(e.entries,"web.pprof","true",o([f("Enables Go pprof debug URI. ")])),Z(e.entries,"web.pprof","false",o([f("Disables pprof. ")]))]))])),Lt("Storage",o([Q(o([Le("config-item")]),o([Ue(o([]),o([f("Type")])),R(o([]),o([f("Selects the storage implementation to use.  Currently Inbucket supports:")])),Z(e.entries,"storage.type","file",o([f(`stores messages as individual files in a nested directory structure
          based on the hash of the mailbox name.  Each mailbox also includes an index
          file to speed up enumeration of the mailbox contents.
          output errors only. `)])),Z(e.entries,"storage.type","memory",o([f("stores messages in RAM, they will be lost if Inbucket is restarted, or crashes, etc. ")])),R(o([]),o([f(`File storage is recommended for larger/shared installations.  Memory is better
      suited to desktop or continuous integration test use cases.`)]))])),q(e.entries,"storage.params","see above","Parameters",!0,o([R(o([]),o([f(`Parameters specific to the storage type selected.  Formatted as a comma
      separated list of key:value pairs.`)])),(()=>{let r=ve(t,"storage.type");if(r.isOk()&&r[0].value==="file"){let n=r[0];return Q(o([]),o([ei(o([]),o([A("file"),f(" type parameters")])),rt(o([]),o([ae(o([]),o([A("path"),f(": Operating system specific path to the directory where mail should be stored. ")]))])),R(o([]),o([f("example: "),A("path:/tmp/inbucket")]))]))}else if(r.isOk()&&r[0].value==="memory"){let n=r[0];return Q(o([]),o([ei(o([]),o([A("memory"),f(" type parameters")])),rt(o([]),o([ae(o([]),o([A("maxkb"),f(`: Maximum size of the mail store in kilobytes.  The oldest messages in
            the store will be deleted to enforce the limit.  In-memory storage has some
            overhead, for now it is recommended to set this to half the total amount of
            memory you are willing to allocate to Inbucket. `)]))])),R(o([]),o([f("example: "),A("maxkb:10240")]))]))}else return f("Unrecognized storage type")})()])),q(e.entries,"storage.retentionPeriod","duration ending in m for minutes, h for hours","Retention Period",!0,o([R(o([]),o([f(`If set, Inbucket will scan the contents of its mail store once per minute,
    removing messages older than this.  This will be enforced regardless of the type
    of storage configured.`)])),R(o([]),o([f("Should be significantly longer than one minute, or 0 to disable.")]))])),q(e.entries,"storage.retentionSleep","duration ending in ms for milliseconds, s for seconds","Retention Sleep",!0,o([f(` Duration to sleep between scanning each mailbox for expired messages.
    Increasing this number will reduce disk thrashing, but extend the length of time
    required to complete a scan of the entire mail store.

    This delay is still enforced for memory stores, but could be reduced from the
    default.  Setting to `),A("0"),f(" may degrade performance of HTTP/SMTP/POP3 services. ")])),q(e.entries,"storage.mailboxMsgCap","positive integer","Per Mailbox Message Cap",!0,o([f(` Maximum messages allowed in a single mailbox, exceeding this will cause older
    messages to be deleted from the mailbox.  A value of `),A("0"),f(" will disable cap enforcement. ")]))])),Lt("Environment Variables",o([Q(o([]),o([Jt(o([]),o([Ws(o([io(r=>new Cr(r))]),o([kt(o([Ze("BashExport")]),"Bash Exports"),kt(o([Ze("DockerCompose")]),"Docker Compose"),kt(o([Ze("DockerShell")]),"Docker Shell"),kt(o([Ze("Systemd")]),"Systemd"),kt(o([Ze("KubernetesConfigMap")]),"Kubernetes configMap")])),f(" Output format ")]))])),Q(o([]),o([Jt(o([]),o([Er(o([so(r=>new Ir(r)),mr("checkbox")])),f(" Show variables that are set to their default value ")]))])),ti(o([])),Q(o([]),ml(e))]))])),ti(o([])),R(o([]),o([f("Please open an "),Ks(o([ns("https://github.com/inbucket/inbucket.org/issues")]),o([f("issue on GitHub")])),f(" to report a problem with this tool.")]))]))}function oo(){en("Hello from configurator!");let e=eo(fl,pl,hl),t=to(e,"#app",void 0);if(!t.isOk())throw zr("let_assert","configurator",16,"main","Pattern match failed, no pattern matched the value.",{value:t})}function _l(e,t,r){let n="\x1B[90m",i="\x1B[39m",s=`${t}:${r}`,u=Ve(e);if(globalThis.process?.stderr?.write){let l=`${n}${s}${i}
${u}
`;process.stderr.write(l)}else if(globalThis.Deno){let l=`${n}${s}${i}
${u}
`;globalThis.Deno.stderr.writeSync(new TextEncoder().encode(l))}else{let l=`${s}
${u}`;globalThis.console.log(l)}return e}function $l(e){let t='"';for(let r=0;r<e.length;r++){let n=e[r];n==`
`?t+="\\n":n=="\r"?t+="\\r":n=="	"?t+="\\t":n=="\f"?t+="\\f":n=="\\"?t+="\\\\":n=='"'?t+='\\"':n<" "||n>"~"&&n<"\xA0"?t+="\\u{"+n.charCodeAt(0).toString(16).toUpperCase().padStart(4,"0")+"}":t+=n}return t+='"',t}function xl(e){let t="dict.from_list([",r=!0,n=[];return e.forEach((i,s)=>{n.push([s,i])}),n.sort(),n.forEach(([i,s])=>{r||(t=t+", "),t=t+"#("+Ve(i)+", "+Ve(s)+")",r=!1}),t+"])"}function gl(e){let t=globalThis.Object.keys(e).map(r=>{let n=Ve(e[r]);return isNaN(parseInt(r))?`${r}: ${n}`:n}).join(", ");return t?`${e.constructor.name}(${t})`:e.constructor.name}function bl(e){let t=Object.getPrototypeOf(e)?.constructor?.name||"Object",r=[];for(let s of Object.keys(e))r.push(`${Ve(s)}: ${Ve(e[s])}`);let n=r.length?" "+r.join(", ")+" ":"";return`//js(${t==="Object"?"":t+" "}{${n}})`}function Ve(e){let t=typeof e;if(e===!0)return"True";if(e===!1)return"False";if(e===null)return"//js(null)";if(e===void 0)return"Nil";if(t==="string")return $l(e);if(t==="bigint"||t==="number")return e.toString();if(globalThis.Array.isArray(e))return`#(${e.map(Ve).join(", ")})`;if(e instanceof Se)return`[${e.toArray().map(Ve).join(", ")}]`;if(e instanceof Et)return`//utfcodepoint(${String.fromCodePoint(e.value)})`;if(e instanceof Ce)return wl(e);if(e instanceof g)return gl(e);if(yl(e))return xl(e);if(e instanceof Set)return`//js(Set(${[...e].map(Ve).join(", ")}))`;if(e instanceof RegExp)return`//js(${e})`;if(e instanceof Date)return`//js(Date("${e.toISOString()}"))`;if(e instanceof Function){let r=[];for(let n of Array(e.length).keys())r.push(String.fromCharCode(n+97));return`//fn(${r.join(", ")}) { ... }`}return bl(e)}function wl(e){let t=e.bitOffset+8*Math.trunc(e.bitSize/8),r=Qt(e,e.bitOffset,t),n=e.bitSize%8;if(n>0){let i=li(e,t,e.bitSize,!1,!1),s=Array.from(r.rawBuffer),u=`${i}:size(${n})`;return s.length===0?`<<${u}>>`:`<<${Array.from(r.rawBuffer).join(", ")}, ${u}>>`}else return`<<${Array.from(r.rawBuffer).join(", ")}>>`}function yl(e){try{return e instanceof ye}catch{return!1}}oo();
